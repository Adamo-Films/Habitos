@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

:root {
  --neon: #51ffe7;
  --gold: #ffe379;
  --crt-blue: #0e55a5;
  --crt-dark: #00253b;
  --white: #fff;
  --text-neon: #67eaff;
  --highlight: #ffe379;
  --highlight-bg: #fff5;
  --mes-arrow: #51ffe7;
  --mes-arrow-ativo: #ff6be7;
  --visual-primary: #51ffe7;
  --visual-secondary: #cf28ff;
  --visual-accent: #ffe379;
  --visual-background: linear-gradient(135deg, #010915 0%, #03162a 45%, #01050f 100%);
  --visual-warp-start: rgba(81, 255, 231, 0.6);
  --visual-warp-end: rgba(207, 40, 255, 0.45);
  --visual-grid-color: rgba(255, 255, 255, 0.04);
  --visual-haze: rgba(7, 170, 210, 0.18);
  --visual-particle-color: #ffe379;
  --visual-particle-glow: rgba(81, 255, 231, 0.6);
  --visual-content-bg: linear-gradient(135deg, rgba(0, 10, 24, 0.78), rgba(0, 18, 44, 0.82));
  --visual-content-border: rgba(81, 255, 231, 0.32);
  --visual-content-shadow: 0 0 45px rgba(0, 0, 0, 0.75), 0 0 85px rgba(0, 0, 0, 0.45), 0 0 40px rgba(81, 255, 231, 0.55);
  --visual-chip-bg: linear-gradient(135deg, rgba(81, 255, 231, 0.12), rgba(207, 40, 255, 0.12));
  --visual-chip-border: rgba(255, 255, 255, 0.18);
  --visual-chip-shadow: 0 0 18px rgba(0, 0, 0, 0.55);
  --visual-chip-color: rgba(255, 255, 255, 0.85);
  --visual-tagline-color: var(--visual-accent);
  --visual-progress-text: rgba(255, 255, 255, 0.78);
  --visual-progress-accent: var(--visual-accent);
  --visual-progress-bar: linear-gradient(90deg, var(--visual-primary), var(--visual-secondary));
  --visual-inner-border: rgba(255, 255, 255, 0.08);
  --visual-content-sheen: linear-gradient(130deg, rgba(81, 255, 231, 0.12), rgba(207, 40, 255, 0.08), rgba(255, 227, 121, 0.12));
  --reward-card-bg: linear-gradient(135deg, rgba(0, 12, 30, 0.85), rgba(0, 28, 60, 0.9));
  --reward-card-border: rgba(81, 255, 231, 0.45);
  --reward-card-glow: 0 0 26px rgba(81, 255, 231, 0.4), 0 0 34px rgba(207, 40, 255, 0.18);
  --reward-card-sheen: rgba(255, 255, 255, 0.16);
  --reward-card-grid-color: rgba(81, 255, 231, 0.18);
  --reward-bar-gradient: linear-gradient(90deg, #cf28ff 10%, #51ffe7 90%);
  --status-indicator-gutter: clamp(18px, 3vw, 60px);
}

/* ========== BASE ========== */
html, body {
  margin: 0; padding: 0; width: 100vw; height: 100vh;
  background: var(--crt-dark);
  font-family: 'Press Start 2P', monospace;
  overflow: hidden;
}
#video-wrapper {
  position: fixed;
  top: 50%;
  left: 50%;
  width: 1920px;
  height: 1080px;
  overflow: hidden;
  z-index: 0;
  transform-origin: center center;
  --wrapper-translate-x: 0px;
  --wrapper-translate-y: 0px;
  --wrapper-scale: max(calc(100vw / 1920), calc(100vh / 1080));
  opacity: 0;
  transform: perspective(1600px) translate(-50%, -50%) translate3d(var(--wrapper-translate-x), var(--wrapper-translate-y), 0) scale(var(--wrapper-scale));
  transition: opacity 0.3s ease, filter 0.6s ease;
}
#video-wrapper::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 10px;
  background: linear-gradient(to bottom, var(--crt-dark) 0%, transparent 100%);
  z-index: 5;
  pointer-events: none;
}
#video-wrapper.visible {
  opacity: 1;
}
body.visualizer-portal #video-wrapper {
  transform: perspective(1600px) translate3d(var(--wrapper-translate-x), var(--wrapper-translate-y), 0) scale(calc(var(--wrapper-scale) * 0.94)) rotateX(7deg);
  filter: brightness(0.6) saturate(150%) blur(8px) contrast(110%) drop-shadow(0 0 28px rgba(81, 255, 231, 0.18)) drop-shadow(0 0 32px rgba(207, 40, 255, 0.16));
}
body.visualizer-portal::before {
  content: "";
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at center, transparent 0%, rgba(0, 0, 0, 0.7) 70%);
  mix-blend-mode: screen;
  pointer-events: none;
  animation: portalShadeIn 0.9s ease forwards;
  z-index: 50;
}

body.visualizer-entering #video-wrapper {
  animation: screenSuck 1.2s cubic-bezier(.11, .75, .14, 1) forwards;
}

body.visualizer-entering::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  mix-blend-mode: screen;
  background: radial-gradient(circle at center, rgba(81, 255, 231, 0.25) 0%, transparent 55%),
              radial-gradient(circle at 50% 40%, rgba(207, 40, 255, 0.35) 0%, transparent 70%);
  animation: tunnelFlash 1.2s ease forwards;
  z-index: 55;
}
.arcade-bg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  pointer-events: none;
}

/* ========== START SCREEN ========== */
#start-screen {
  position: absolute;
  inset: 0;
  background: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 20;
  text-align: center;
}

#start-screen .start-title {
  color: var(--highlight);
  text-shadow: 0 0 24px #ffe379b6, 0 0 36px #31fcff99, 0 0 45px #31fcff77;
  font-size: 1.1em;
  margin: 0 20px 40px 20px;
}

#start-screen .press-start {
  font-size: 2.4em;
  color: var(--highlight);
  text-shadow: 0 0 24px #ffe379b6, 0 0 36px #31fcff99, 0 0 45px #31fcff77;
  animation: press-blink 1s steps(2, start) infinite;
}

#start-screen.hidden {
  animation: startFade 0.6s forwards;
  pointer-events: none;
}

@keyframes press-blink {
  0%, 50% { opacity: 1; }
  50.01%, 100% { opacity: 0; }
}

@keyframes startFade {
  to { opacity: 0; visibility: hidden; }
}

/* ========== BANNER ========== */
.banner-gamer {
  position: absolute; left: 50%; top: -2px; width: 98vw; max-width: 770px; min-width: 160px;
  height: auto; transform: translateX(-50%); z-index: 22;
  display: flex; align-items: center; justify-content: center; pointer-events: none;
}
.banner-gamer-img {
  width: 98%; max-width: 750px; min-width: 120px;
  height: auto; max-height: 220px; min-height: 75px;
  display: block; object-fit: contain;
  filter: drop-shadow(0 0 30px #19e0fcaa) drop-shadow(0 0 60px #ff38fdaa);
  pointer-events: none;
}

/* ========== CONTADORES ========== */
.arcade-counters {
  position: absolute;
  top: 0;
  left: 0;
  width: 1920px;
  height: 1080px;
  z-index: 30;
  pointer-events: none;
  background: none !important;
  transform: none;
  opacity: 0;
}
.counter-label, .counter-value {
  text-align: center; width: 100%; pointer-events: none;
}
.counter-label {
  font-family: 'Press Start 2P', monospace;
  font-size: 1.2em; color: #fff;
  text-shadow: 0 2px 14px #19e0fcaa, 0 1px 12px #000d, 0 1px 30px #ffe379bb;
  font-weight: 900; letter-spacing: 0.09em; line-height: 1.12;
  margin: 0 0 18px 0; padding: 0; text-transform: uppercase;
}
.counter-value {
  font-family: 'Press Start 2P', monospace;
  font-size: 3.2em;
  background: linear-gradient(90deg,#ffe379 55%,#51ffe7 80%,#d6e4ff 100%);
  color: #fdf5c6;
  font-weight: 900; letter-spacing: 0.03em;
  text-shadow: 0 2px 12px #ffe379, 0 0 22px #1ffbf4bb, 0 8px 35px #1fc8ffd0;
  border-radius: 16px; display: inline-block; padding: 0 10px 0 10px;
  margin: 0; background-clip: text;
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  line-height: 1; width: 100%; transform: none;
}

/* counter boxes on the top of the page */
.counter-box {
  position: absolute;
  width: 330px;
  height: 220px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  pointer-events: none;
}

#seguidos-counter {
  left: calc(420px - 0.33cm);
  top: calc(55px - 2cm + 0.33cm + 1.5cm - 0.33cm);
}

#record-counter {
  left: calc(420px - 0.33cm);
  top: calc(55px - 2cm + 0.33cm + 1.5cm - 0.33cm);
}

#feitos-counter {
  left: calc(1170px - 0.33cm + 0.5cm - 0.25cm);
  top: calc(55px - 2cm + 0.33cm + 1.5cm - 0.33cm);
}
#feitos-counter .counter-label {
  font-size: 1.18em;
  max-width: 100%;
  white-space: normal;

  margin-bottom: 10px; /* more space for progress bar */
}
#feitos-counter .counter-value {
  font-size: 1.18em;
}

#feitos-counter .counter-progress-bg {
  width: calc((100% - 1cm) * 0.67); /* shrink horizontally */
  height: 12px;
  background: rgba(0, 0, 0, 0.05);
  border-radius: 6px;
  overflow: hidden;
  margin: 4px auto 12px; /* centered and more space */
  box-shadow: 0 0 12px #51ffe799, 0 0 5px #cf28ff33;
}
#feitos-counter .counter-progress {
  height: 100%;
  width: 0;
  background: linear-gradient(90deg, #cf28ff 10%, #51ffe7 90%);
  border-radius: inherit;
  transition: width 0.45s cubic-bezier(.6,1.2,.16,1.08);
  box-shadow: 0 0 10px #cf28ff88, 0 0 5px #51ffe799;
}

/* ========== TELA PRINCIPAL CRT ========== */
.arcade-screen-curve {
  position: absolute; left: 50%; top: 54%;
  width: 88%; height: 68%; max-width: 870px; max-height: 490px; min-width: 240px; min-height: 120px;
  transform: translate(-50%, -50%); z-index: 10;
  border-radius: 80px 70px 80px 80px/90px 100px 85px 78px;
  background: none !important;
  display: flex; flex-direction: column; justify-content: flex-start; align-items: stretch;
  padding: 0; pointer-events: auto; overflow: visible;
  box-shadow: none !important;
}

/* ==== Remove fundo container ==== */
.container, .calendario-container, #calendario, .reward-card {
  background: none !important;
  box-shadow: none !important;
}

/* ========== CALENDÁRIO E MES ========== */
#calendario {
  position: absolute; left: 50%; top: 50%; width: 88%; height: 92%;
  max-width: 100%; max-height: 99%; min-width: 120px; min-height: 70px;
  transform: translate(-50%, -50%);
  display: flex; flex-direction: column;
  color: #ffe379;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.9em;
  padding: 0 1vw 140px 1vw;
  overflow-y: auto;
  box-sizing: border-box;
  border: none !important;
  cursor: default;
  user-select: none;
  position: relative;
  opacity: 0;
}
#calendario.vertical-center {
  justify-content: center;
}

#calendario {
  --top-mask-start: 0px;
  --top-fade-size: 50px;
  --bottom-mask-stop: 50px;
  -webkit-mask-image: linear-gradient(
      to bottom,
      transparent 0,
      transparent var(--top-mask-start),
      black calc(var(--top-mask-start) + var(--top-fade-size)),
      black calc(100% - var(--bottom-mask-stop)),
      transparent
  );
          mask-image: linear-gradient(
      to bottom,
      transparent 0,
      transparent var(--top-mask-start),
      black calc(var(--top-mask-start) + var(--top-fade-size)),
      black calc(100% - var(--bottom-mask-stop)),
      transparent
  );
  -webkit-mask-size: 100% 100%;
          mask-size: 100% 100%;
}
#calendario, #calendario th, #calendario td, #calendario .progress-text,
#calendario .mes, #calendario .habit-label, #calendario .habit-emoji, #calendario .habit-item {
  text-shadow: 0 0 10px #31fcff66, 0 0 16px #ffe37933, 0 0 2px #fff4;
}
#calendario .habit-emoji {
  filter: drop-shadow(0 0 6px #51ffe7cc) drop-shadow(0 0 8px #ffe37966);
  font-size: 1.6em;
}

.emoji {
  width: 1em;
  height: 1em;
  image-rendering: pixelated;
}

/* === ANO === */
.ano {
  font-family: 'Press Start 2P', monospace;
  font-size: 3em;
  color: var(--highlight);
  margin: 40px auto 20px auto;
  background: none !important;
  border: none !important;
  cursor: pointer;
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  padding: 0;
  text-shadow: 0 0 24px #ffe379b6, 0 0 36px #31fcff99, 0 0 45px #31fcff77;
  transition: color 0.17s cubic-bezier(.47,1.64,.41,.88);
  width: fit-content;
}
.ano:hover { color: #51ffe7; text-shadow: 0 0 16px #51ffe788, 0 0 40px #ffe37944; }
.ano:active { transform: scale(0.97); }
.ano:not(.open) { opacity: 0.85; }
.ano .arcade-arrow {
  position: absolute;
  left: -62px;
  top: 50%;
  transform: translateY(-50%);
}

.ano.open {
  /* sticky control via JavaScript */
}

/* sticky header when dropdown exceeds container */
.ano.sticky-title,
.mes.sticky-title,
tr.main-row.sticky-title {
  position: sticky;
  top: 40px;
  margin-top: 0;
  background: none !important;
  visibility: hidden;
  z-index: 20;
}

/* overlay para titulo sticky fora do mascaramento */
#sticky-title-overlay {
  position: absolute;
  top: 40px;
  left: 0;
  width: 100%;
  display: none;
  z-index: 25;
  pointer-events: none;
}

/* === STATUS INDICATORS === */
#status-indicators {
  position: absolute;
  top: calc(clamp(-60px, -6%, 24px) + 0.5cm - 3mm);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 6cm;
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.35s ease;
  z-index: 26;
}

#status-indicators.active {
  opacity: 1;
  visibility: visible;
}

#life-container,
#level-container {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1.5em;
  pointer-events: none;
  opacity: 0;
  overflow: visible;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#level-container {
  text-align: right;
  justify-content: flex-end;
}

#life-container.show,
#level-container.show {
  opacity: 1;
}

.life-heart {
  filter: drop-shadow(0 0 8px #4dffe2cc);
  animation: heart-glow 1.6s ease-in-out infinite alternate;
}

.life-label {
  margin-right: 6px;
  font-size: 0.6em;
  color: var(--highlight);
  text-shadow: 0 0 8px #4dffe2cc;
}

.level-label {
  margin-right: 6px;
  font-size: 0.6em;
  color: var(--highlight);
  text-shadow: 0 0 8px #ffe379aa;
}

.level-value {
  font-size: 0.9em;
  letter-spacing: 0.08em;
  color: var(--text-neon);
  text-shadow: 0 0 18px rgba(81, 255, 231, 0.6), 0 0 28px rgba(207, 40, 255, 0.45);
}

@keyframes heart-glow {
  0% { filter: drop-shadow(0 0 6px #4dffe2b5) drop-shadow(0 0 10px #3dffcb80); }
  100% { filter: drop-shadow(0 0 12px #6efff2) drop-shadow(0 0 22px #1fffaf); }
}

/* === MES === */
.mes {
  font-family: 'Press Start 2P', monospace;
  font-size: 2.5em;
  color: var(--highlight);
  margin: 28px auto 17px auto;
  background: none !important; border: none !important;
  cursor: pointer; user-select: none;
  display: flex; align-items: center; justify-content: center;
  gap: 24px;
  position: relative;
  z-index: 10;
  text-shadow: 0 0 24px #ffe379b6, 0 0 36px #31fcff99, 0 0 45px #31fcff77;
  transition: color 0.17s cubic-bezier(.47,1.64,.41,.88);
  padding: 0;
  width: fit-content;
}
.arcade-arrow {
  position: absolute;
  left: -62px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
}
.mes .mes-label { z-index: 2; }
.mes:hover { color: #51ffe7; text-shadow: 0 0 16px #51ffe788, 0 0 40px #ffe37944; }
.mes:active { transform: scale(0.97); }
.mes:not(.open) { opacity: 0.85; }
.mes.open {
  /* sticky control via JavaScript */
}

.neon-arrow {
  position: absolute;
  left: 0;
  top: 50%;
  width: 0;
  height: 0;
  border-top: 24px solid transparent;
  border-bottom: 24px solid transparent;
  border-left: 52px solid var(--mes-arrow);
  filter: drop-shadow(0 0 6px var(--mes-arrow)) drop-shadow(0 0 12px var(--mes-arrow));
  animation: arrow-move 0.8s infinite alternate;
  transform: translateY(-50%);
  pointer-events: none;
}

.ano-atual .neon-arrow,
.mes-atual .neon-arrow,
tr.main-row.current-day td:first-child::before {
  border-left-color: var(--mes-arrow-ativo);
}

@keyframes arrow-move {
  0% { transform: translate(-3px, -50%); }
  100% { transform: translate(3px, -50%); }
}

tr.main-row.current-day td:first-child::before {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  width: 0;
  height: 0;
  border-top: 10px solid transparent;
  border-bottom: 10px solid transparent;
  border-left: 28px solid var(--mes-arrow);
  filter: drop-shadow(0 0 6px var(--mes-arrow)) drop-shadow(0 0 12px var(--mes-arrow));
  animation: arrow-move 0.8s infinite alternate;
  transform: translateY(-50%);
  pointer-events: none;
}


/* ========== TABELA ========== */
table {
  border-collapse: collapse;
  width: 100%;
  color: #fff;
  margin-bottom: 18px;
  border: none !important;
  background: none !important;
  box-shadow: none !important;
}
th, td {
  padding: 7px 10px;
  font-size: 1em;
  text-align: left;
  background: transparent !important;
  border: none !important;
}

#calendario .mes-dropdown table {
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  border-collapse: separate;
}

#calendario .mes-dropdown table,
#calendario .mes-dropdown table th,
#calendario .mes-dropdown table td {
  box-sizing: border-box;
}

#calendario .mes-dropdown table colgroup {
  display: none;
}

#calendario .mes-dropdown table thead,
#calendario .mes-dropdown table tbody {
  display: block;
  width: 100%;
}

#calendario .mes-dropdown table thead tr,
#calendario .mes-dropdown table tbody tr.main-row {
  display: grid;
  grid-template-columns: minmax(120px, 0.22fr) minmax(200px, 0.46fr) minmax(140px, 0.32fr);
  align-items: center;
  width: 100%;
}

#calendario .mes-dropdown table thead th,
#calendario .mes-dropdown table tbody tr.main-row > td {
  display: block;
  width: 100%;
}

#calendario .mes-dropdown table tbody tr.dropdown {
  display: block;
}

#calendario .mes-dropdown table tbody tr.dropdown > td {
  display: block;
  width: 100%;
}

#calendario .mes-dropdown table thead th:first-child {
  padding-left: 34px;
}

#calendario .mes-dropdown tr.dropdown td {
  padding: 18px 34px;
}

/* ==== Linhas principais === */
tr.main-row {
  cursor: pointer;
  background: transparent !important;
  color: #ffe379;
  border-radius: 17px;
  transition: color 0.22s, background 0.22s, filter 0.25s;
  position: relative;
  min-height: 40px;
  overflow: hidden;
  isolation: isolate;
  --day-progress: 0;
}
tr.main-row::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(90deg, rgba(66, 24, 160, 0.32) 0%, rgba(143, 60, 255, 0.32) 100%);
  transform-origin: left center;
  transform: scaleX(var(--day-progress, 0));
  opacity: 0;
  transition: transform 0.4s cubic-bezier(.55, .12, .32, 1.32), opacity 0.28s ease;
  pointer-events: none;
  z-index: 0;
}
tr.main-row.day-has-progress::before {
  opacity: 1;
}
tr.main-row.day-complete::before {
  background: linear-gradient(90deg, rgba(74, 16, 158, 0.55) 0%, rgba(167, 62, 255, 0.55) 100%);
}
tr.main-row > td {
  position: relative;
  z-index: 1;
}
tr.main-row td:first-child {
  padding-left: 34px;
  position: relative;
}
tr.main-row:hover, .habit-item:hover, .reward-card:hover {
  filter: brightness(1.08) saturate(1.07) drop-shadow(0 0 7px #31fcff35);
  background: rgba(81,255,231,0.05) !important;
}
tr.main-row:active, .habit-item:active, .reward-card:active {
  filter: brightness(1.11) saturate(1.12) drop-shadow(0 0 12px #cf28ff25);
}
tr.main-row.expanded {
  background: linear-gradient(90deg, #31fcff17 0%, #ffe3791f 90%) !important;
  filter: brightness(1.04) saturate(1.02);
}

tr.main-row {
  --progress-covered-color: #000000;
}

.progress-text {
  position: relative;
  --progress-text-color: currentColor;
  color: var(--progress-text-color);
}

.progress-text-content {
  position: relative;
  display: block;
  width: 100%;
}

.progress-text-base,
.progress-text-cover {
  display: block;
  position: relative;
  z-index: 1;
  font: inherit;
  letter-spacing: inherit;
  line-height: inherit;
  text-shadow: inherit;
  white-space: inherit;
}

.progress-text-base {
  color: var(--progress-text-color, currentColor);
}

.progress-text-cover {
  position: absolute;
  inset: 0;
  color: var(--progress-covered-color, #000);
  clip-path: inset(0 var(--progress-cover-uncovered, 100%) 0 0);
  transition: clip-path 0.4s cubic-bezier(.55, .12, .32, 1.32);
  pointer-events: none;
  z-index: 2;
}

/* ==== Highlight Arcade Clean ==== */
tr.main-row.day-complete {
  color: #050505 !important;
  font-weight: bold;
  text-shadow: 0 1px 3px rgba(247, 239, 255, 0.78), 0 0 18px rgba(40, 0, 89, 0.3);
  box-shadow: 0 0 22px rgba(104, 21, 255, 0.25), 0 0 12px rgba(160, 63, 255, 0.35);
  filter: brightness(1.08) contrast(1.04);
  animation: arcade-glow 1.9s infinite alternate;
}

.habit-item.habit-complete {
  background: linear-gradient(90deg, rgba(66, 24, 160, 0.38) 0%, rgba(143, 60, 255, 0.38) 100%) !important;
  color: #050505 !important;
  font-weight: bold;
  text-shadow: 0 1px 3px rgba(247, 239, 255, 0.7);
  border-radius: 22px 20px 22px 20px;
  filter: brightness(1.08) contrast(1.05);
  box-shadow: 0 0 22px rgba(104, 21, 255, 0.22), 0 0 12px rgba(160, 63, 255, 0.32);
  animation: arcade-glow 1.9s infinite alternate;
}
@keyframes arcade-glow {
  0% { filter: brightness(1.06) saturate(1.05);}
  100% { filter: brightness(1.14) saturate(1.12);}
}

.progress-text.gold {
  --progress-text-color: #ffe379;
  color: #ffe379;
  text-shadow: 0 0 8px #ffe379cc, 0 0 16px #ffd90099;
}

/* ==== Expand animação dos dropdowns ==== */
tr.dropdown {
  background: none !important;
  animation: dropdown-open 0.33s cubic-bezier(.7,0,.5,1.2) backwards;
  overflow: hidden;
}
@keyframes dropdown-open {
  0% { opacity: 0; transform: scaleY(0.6) translateY(-32px);}
  100% { opacity: 1; transform: scaleY(1) translateY(0);}
}
tr.dropdown[style*="display: none;"] {
  animation: dropdown-close 0.25s cubic-bezier(.5,0,.7,1.1) backwards;
}
@keyframes dropdown-close {
  0% { opacity: 1; transform: scaleY(1);}
  100% { opacity: 0; transform: scaleY(0.2) translateY(-16px);}
}

/* ==== HÁBITOS ==== */
.habit-list {
  gap: 13px;
  margin: 6px 0;
  display: flex;
  flex-direction: column;
}
.habit-item {
  display: grid; grid-template-columns: 46px 1fr 38px; align-items: center;
  background: none !important;
  padding: 8px 16px; border-radius: 13px;
  box-shadow: none; color: none; transition: background 0.22s;
  position: relative; font-size: 1.03em; cursor: pointer;
  z-index: 2;
}
.habit-label { cursor: pointer; user-select: none; font-family: inherit;}
.habit-checkbox {
  width: 28px; height: 28px; border-radius: 4px;
  margin-left: 8px;
  background: repeating-linear-gradient(45deg,#222 0 4px,#000 4px 8px);
  border: 2px solid var(--neon);
  box-shadow: 0 0 5px #51ffe7bb;
  outline: none;
  cursor: pointer;
  position: relative;
  appearance: none;
  transition: filter 0.16s, box-shadow 0.16s;
  font-family: 'Press Start 2P', monospace;
  color: var(--highlight);
  text-align: center;
  image-rendering: pixelated;
}
.habit-checkbox:checked {
  border-color: var(--highlight);
}
.habit-checkbox::after {
  content: '';
  position: absolute;
  inset: 0;
}
.habit-checkbox:checked::after {
  content: '✔';
  font-size: 18px;
  line-height: 28px;
  text-shadow: 0 0 5px var(--highlight);
  filter: drop-shadow(0 0 3px var(--highlight));
}

.habit-item.diary-habit {
  border: 1px solid transparent;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.habit-item.diary-habit.diary-filled {
  border-color: rgba(255, 227, 121, 0.85);
  box-shadow: 0 0 18px rgba(255, 227, 121, 0.35), 0 0 10px rgba(81, 255, 231, 0.25);
}

.habit-item.diary-habit.diary-filled::after {
  content: 'SALVO';
  position: absolute;
  top: -12px;
  right: 18px;
  background: linear-gradient(90deg, rgba(255, 227, 121, 0.95), rgba(81, 255, 231, 0.9));
  color: #001130;
  font-size: 0.48em;
  letter-spacing: 0.18em;
  padding: 6px 12px;
  border-radius: 999px;
  box-shadow: 0 0 12px rgba(255, 227, 121, 0.45);
}

.habit-item.weight-habit {
  border: 1px solid transparent;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
  position: relative;
}

.habit-item.weight-habit.weight-filled {
  border-color: rgba(255, 227, 121, 0.85);
  box-shadow: 0 0 18px rgba(255, 227, 121, 0.35), 0 0 10px rgba(81, 255, 231, 0.25);
}

.habit-item.weight-habit.weight-filled::after {
  content: 'PESO';
  position: absolute;
  top: -12px;
  right: 18px;
  background: linear-gradient(90deg, rgba(255, 227, 121, 0.9), rgba(81, 255, 231, 0.85));
  color: #001130;
  font-size: 0.48em;
  letter-spacing: 0.18em;
  padding: 6px 12px;
  border-radius: 999px;
  box-shadow: 0 0 12px rgba(255, 227, 121, 0.4);
}

.weight-latest {
  margin-top: 10px;
  font-size: 0.52em;
  letter-spacing: 0.08em;
  color: rgba(255, 227, 121, 0.9);
  text-transform: uppercase;
  display: none;
}

.diary-editor {
  margin-top: 22px;
  padding: 20px 22px 22px 22px;
  border-radius: 20px;
  border: 1px solid rgba(81, 255, 231, 0.55);
  background: linear-gradient(135deg, rgba(0, 17, 43, 0.82), rgba(0, 28, 60, 0.78));
  box-shadow: 0 0 22px rgba(81, 255, 231, 0.15), inset 0 0 16px rgba(0, 0, 0, 0.35);
}

.weight-editor {
  margin-top: 18px;
  padding: 18px 22px 20px 22px;
  border-radius: 18px;
  border: 1px solid rgba(255, 227, 121, 0.55);
  background: linear-gradient(135deg, rgba(34, 15, 0, 0.85), rgba(12, 8, 0, 0.82));
  box-shadow: 0 0 20px rgba(255, 227, 121, 0.18), inset 0 0 16px rgba(0, 0, 0, 0.35);
}

.weight-input-group {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}

.weight-input {
  width: 140px;
  padding: 12px 14px;
  border-radius: 12px;
  border: 2px solid rgba(255, 227, 121, 0.75);
  background: rgba(0, 0, 0, 0.45);
  color: var(--highlight);
  font-family: 'Press Start 2P', monospace;
  font-size: 0.64em;
  text-align: center;
  letter-spacing: 0.08em;
  outline: none;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.weight-input:focus {
  border-color: rgba(255, 227, 121, 1);
  box-shadow: 0 0 16px rgba(255, 227, 121, 0.35);
}

.weight-input-error {
  border-color: rgba(255, 111, 111, 0.95) !important;
  box-shadow: 0 0 16px rgba(255, 111, 111, 0.35) !important;
}

.weight-unit {
  font-size: 0.6em;
  letter-spacing: 0.12em;
  color: rgba(255, 227, 121, 0.9);
  text-transform: uppercase;
}

.weight-actions {
  display: flex;
  gap: 12px;
}

.weight-save,
.weight-cancel {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.58em;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  padding: 10px 16px;
  border-radius: 14px;
  border: 2px solid rgba(255, 227, 121, 0.7);
  background: rgba(30, 12, 0, 0.82);
  color: var(--highlight);
  cursor: pointer;
  transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
}

.weight-save:hover,
.weight-cancel:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 20px rgba(255, 227, 121, 0.35);
}

.weight-save:active,
.weight-cancel:active {
  transform: translateY(1px) scale(0.98);
}

.weight-save:disabled {
  opacity: 0.65;
  cursor: not-allowed;
}

.diary-textarea {
  width: 100%;
  min-height: 150px;
  resize: vertical;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.72em;
  line-height: 1.7;
  letter-spacing: 0.03em;
  color: var(--highlight);
  background: rgba(0, 12, 34, 0.82);
  border: 2px solid rgba(81, 255, 231, 0.65);
  border-radius: 14px;
  padding: 16px 18px;
  box-shadow: inset 0 0 18px rgba(0, 0, 0, 0.45), 0 0 16px rgba(81, 255, 231, 0.12);
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
  color-scheme: dark;
  caret-color: var(--neon);
}

.diary-textarea::placeholder {
  color: rgba(103, 234, 255, 0.55);
}

.diary-textarea:focus {
  outline: none;
  border-color: var(--highlight);
  box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.38), 0 0 22px rgba(255, 227, 121, 0.35);
}

.diary-actions {
  margin-top: 16px;
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: flex-end;
}

.diary-save,
.diary-cancel {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.66em;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  border-radius: 14px;
  padding: 12px 22px;
  cursor: pointer;
  transition: transform 0.18s ease, box-shadow 0.18s ease, filter 0.18s ease;
}

.diary-save {
  border: 2px solid rgba(255, 227, 121, 0.95);
  background: linear-gradient(90deg, rgba(255, 227, 121, 0.92), rgba(81, 255, 231, 0.9));
  color: #001130;
  box-shadow: 0 0 18px rgba(255, 227, 121, 0.45), 0 0 20px rgba(81, 255, 231, 0.3);
}

.diary-save:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 0 24px rgba(255, 227, 121, 0.55), 0 0 26px rgba(81, 255, 231, 0.35);
}

.diary-save:active:not(:disabled) {
  transform: translateY(1px) scale(0.98);
}

.diary-save:disabled {
  opacity: 0.7;
  cursor: not-allowed;
  box-shadow: none;
}

.diary-cancel {
  border: 2px solid rgba(103, 234, 255, 0.6);
  background: rgba(0, 12, 34, 0.7);
  color: var(--highlight);
  box-shadow: 0 0 16px rgba(81, 255, 231, 0.22);
}

.diary-cancel:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 22px rgba(81, 255, 231, 0.32);
}

.diary-cancel:active {
  transform: translateY(1px) scale(0.98);
}

.diary-log-button-wrapper {
  position: absolute;
  left: 50%;
  top: calc(96% + 32px);
  transform: translate(-50%, 12px);
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 12px;
  pointer-events: none;
  z-index: 40;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.diary-log-button-wrapper.show {
  opacity: 1;
  visibility: visible;
  transform: translate(-50%, 0);
}

.diary-log-button-wrapper .diary-log-button {
  pointer-events: auto;
}

.diary-log-button {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.6em;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  padding: 10.5px 21px;
  border-radius: 15px;
  border: 2px solid var(--gold);
  background: rgba(0, 18, 46, 0.72);
  color: var(--highlight);
  box-shadow: 0 0 22px rgba(255, 227, 121, 0.28), 0 0 28px rgba(207, 40, 255, 0.18);
  cursor: pointer;
  transition: transform 0.18s ease, box-shadow 0.18s ease;
}

.diary-log-button.active {
  border-color: var(--neon);
  background: rgba(0, 32, 60, 0.85);
  color: var(--text-neon);
  box-shadow: 0 0 26px rgba(81, 255, 231, 0.5), 0 0 30px rgba(0, 255, 191, 0.38);
}

.diary-log-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 26px rgba(81, 255, 231, 0.45), 0 0 32px rgba(207, 40, 255, 0.35);
}

.diary-log-button:active {
  transform: translateY(1px) scale(0.98);
}

.diary-log-panel,
.weight-log-panel {
  display: none;
  width: 100%;
  flex: 1;
  justify-content: center;
  align-items: stretch;
  padding: 24px 0 40px;
  min-height: 0;
}

.diary-log-content,
.weight-log-content {
  width: min(820px, 94%);
  height: 100%;
  max-height: none;
  background: linear-gradient(135deg, rgba(0, 21, 48, 0.94), rgba(12, 8, 32, 0.96));
  border: 2px solid rgba(81, 255, 231, 0.82);
  border-radius: 28px;
  box-shadow: 0 0 40px rgba(81, 255, 231, 0.32), 0 0 60px rgba(0, 255, 191, 0.24);
  padding: 22px 28px 26px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  min-height: 0;
}

.diary-log-header,
.weight-log-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
  gap: 18px;
}

.diary-log-panel.diary-locked .diary-log-list {
  pointer-events: none;
  user-select: none;
  opacity: 0.55;
}

.diary-locker {
  position: relative;
  border: 1px solid rgba(255, 227, 121, 0.45);
  border-radius: 18px;
  padding: 18px 20px 20px;
  background: linear-gradient(135deg, rgba(0, 20, 48, 0.8), rgba(48, 9, 54, 0.55));
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
  overflow: hidden;
  margin-bottom: 12px;
  transition: opacity 0.35s ease, transform 0.35s ease;
}

.diary-locker.hidden {
  opacity: 0;
  transform: translateY(-6px);
  pointer-events: none;
  display: none;
}

.diary-locker-glow {
  position: absolute;
  inset: -60%;
  background: radial-gradient(circle at 50% 50%, rgba(81, 255, 231, 0.12), rgba(207, 40, 255, 0.08), transparent 55%);
  filter: blur(50px);
  opacity: 0.75;
  pointer-events: none;
}

.diary-locker-inner {
  position: relative;
  display: grid;
  gap: 10px;
  z-index: 1;
}

.diary-locker-icon {
  font-size: 1.1em;
  filter: drop-shadow(0 0 8px rgba(255, 227, 121, 0.55));
  animation: diaryPulse 1.6s ease-in-out infinite;
}

.diary-locker-text {
  color: rgba(255, 255, 255, 0.85);
  font-size: 0.7em;
  line-height: 1.6;
  letter-spacing: 0.02em;
}

.diary-locker-form {
  display: flex;
  gap: 12px;
  align-items: center;
  flex-wrap: wrap;
}

.diary-unlock-input {
  flex: 1 1 180px;
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px solid rgba(81, 255, 231, 0.45);
  background: rgba(2, 14, 36, 0.85);
  color: #e6f9ff;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.62em;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  outline: none;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.diary-unlock-input:focus-visible {
  border-color: rgba(255, 227, 121, 0.9);
  box-shadow: 0 0 14px rgba(255, 227, 121, 0.4);
}

.diary-unlock-button {
  padding: 12px 16px;
  border-radius: 14px;
  border: 1px solid rgba(255, 227, 121, 0.85);
  background: linear-gradient(135deg, rgba(255, 227, 121, 0.2), rgba(81, 255, 231, 0.18));
  color: #ffe379;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.58em;
  letter-spacing: 0.08em;
  cursor: pointer;
  box-shadow: 0 0 18px rgba(255, 227, 121, 0.32);
  transition: transform 0.15s ease, box-shadow 0.2s ease;
}

.diary-unlock-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 20px rgba(255, 227, 121, 0.4);
}

.diary-unlock-button:active {
  transform: translateY(1px) scale(0.99);
}

.diary-locker-feedback {
  min-height: 18px;
  font-size: 0.6em;
  color: #91ffda;
  letter-spacing: 0.04em;
}

.diary-locker-feedback.show-error {
  color: #ffb3b3;
}

.diary-locker.diary-locker-shake {
  animation: diaryShake 0.4s ease;
}

.diary-locker.diary-locker-success {
  box-shadow: 0 0 24px rgba(81, 255, 231, 0.45), 0 0 28px rgba(255, 227, 121, 0.35);
}

.diary-locked-banner {
  display: flex;
  gap: 12px;
  align-items: center;
  padding: 16px 18px;
  border: 1px dashed rgba(255, 227, 121, 0.5);
  border-radius: 16px;
  background: linear-gradient(135deg, rgba(0, 18, 44, 0.7), rgba(48, 10, 60, 0.6));
}

.diary-locked-icon {
  font-size: 1em;
  filter: drop-shadow(0 0 8px rgba(255, 227, 121, 0.5));
}

.diary-locked-text p {
  margin: 0;
  color: rgba(255, 255, 255, 0.85);
  font-size: 0.62em;
}

.diary-locked-cta {
  margin-top: 8px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 10px 12px;
  border: 1px solid rgba(81, 255, 231, 0.55);
  border-radius: 12px;
  background: rgba(0, 16, 36, 0.8);
  color: #9cf7ff;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.55em;
  letter-spacing: 0.06em;
  cursor: pointer;
  transition: transform 0.15s ease, box-shadow 0.2s ease;
}

.diary-locked-cta:hover {
  transform: translateY(-1px);
  box-shadow: 0 0 16px rgba(81, 255, 231, 0.35);
}

.diary-locked-cta:active {
  transform: translateY(1px) scale(0.99);
}

@keyframes diaryPulse {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.08); opacity: 0.8; }
}

@keyframes diaryShake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-6px); }
  50% { transform: translateX(6px); }
  75% { transform: translateX(-4px); }
  100% { transform: translateX(0); }
}

.diary-log-title,
.weight-log-title {
  color: var(--highlight);
  font-size: 0.96em;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  text-shadow: 0 0 18px rgba(255, 227, 121, 0.6), 0 0 28px rgba(81, 255, 231, 0.35);
}

.diary-log-close,
.weight-log-close {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.6em;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  border-radius: 14px;
  padding: 10px 18px;
  border: 2px solid rgba(255, 227, 121, 0.8);
  background: rgba(0, 12, 34, 0.7);
  color: var(--highlight);
  cursor: pointer;
  box-shadow: 0 0 18px rgba(255, 227, 121, 0.35);
  transition: transform 0.18s ease, box-shadow 0.18s ease;
}

.diary-log-reset {
  border-color: rgba(255, 99, 99, 0.75);
  color: #ffb3b3;
  box-shadow: 0 0 18px rgba(255, 99, 99, 0.35);
}

.diary-log-reset:hover {
  box-shadow: 0 0 22px rgba(255, 99, 99, 0.45);
}

.diary-log-reset:disabled {
  opacity: 0.65;
  cursor: not-allowed;
  transform: none;
  box-shadow: 0 0 12px rgba(255, 99, 99, 0.25);
}

.diary-log-close:hover,
.weight-log-close:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 22px rgba(255, 227, 121, 0.45);
}

.diary-log-close:active,
.weight-log-close:active {
  transform: translateY(1px) scale(0.98);
}



.diary-log-list,
.weight-log-list {
  flex: 1;
  overflow-y: auto;
  padding-right: 6px;
  margin-top: 6px;
  min-height: 0;
  -webkit-overflow-scrolling: touch;
  touch-action: pan-y;
  scrollbar-width: none;
}

.diary-log-list::-webkit-scrollbar,
.weight-log-list::-webkit-scrollbar {
  width: 0;
  height: 0;
}

.diary-log-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding-right: 4px;
}

.diary-entry-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.diary-entry {
  position: relative;
  border-radius: 20px;
  border: 1px solid rgba(81, 255, 231, 0.32);
  background: linear-gradient(135deg, rgba(0, 18, 44, 0.82), rgba(0, 10, 28, 0.88));
  box-shadow: 0 12px 32px rgba(0, 0, 0, 0.32);
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
  overflow: hidden;
}

.diary-entry::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  background: linear-gradient(135deg, rgba(81, 255, 231, 0.14), rgba(207, 40, 255, 0.08));
  opacity: 0;
  transition: opacity 0.2s ease;
}

.diary-entry.open {
  border-color: rgba(81, 255, 231, 0.6);
  box-shadow: 0 18px 40px rgba(0, 0, 0, 0.38), 0 0 26px rgba(81, 255, 231, 0.28);
}

.diary-entry.open::after {
  opacity: 1;
}

.diary-entry-toggle {
  width: 100%;
  display: flex;
  align-items: flex-start;
  gap: 18px;
  padding: 22px 26px;
  background: transparent;
  border: none;
  color: inherit;
  font-family: 'Press Start 2P', monospace;
  font-size: 1em;
  cursor: pointer;
  text-align: left;
}

.diary-entry-toggle:hover .diary-entry-preview {
  color: rgba(255, 255, 255, 0.92);
}

.diary-entry-toggle:focus-visible {
  outline: 2px solid rgba(81, 255, 231, 0.7);
  outline-offset: 3px;
}

.diary-entry-date {
  flex-shrink: 0;
  min-width: 120px;
  font-size: 0.56em;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(255, 227, 121, 0.9);
}

.diary-entry-preview {
  flex: 1;
  font-size: 0.62em;
  letter-spacing: 0.04em;
  line-height: 1.6;
  color: rgba(255, 255, 255, 0.85);
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.diary-entry-icon {
  flex-shrink: 0;
  font-size: 0.6em;
  color: rgba(103, 234, 255, 0.7);
  margin-left: 12px;
  transition: transform 0.2s ease, color 0.2s ease;
}

.diary-entry.open .diary-entry-icon {
  transform: rotate(180deg);
  color: rgba(255, 227, 121, 0.9);
}

.diary-entry-body {
  padding: 0 26px 24px 26px;
  border-top: 1px solid rgba(81, 255, 231, 0.18);
}

.diary-entry-body[hidden] {
  display: none;
}

.diary-entry-text {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.64em;
  line-height: 1.7;
  letter-spacing: 0.04em;
  color: rgba(255, 255, 255, 0.88);
}

.weight-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 18px;
  margin-bottom: 24px;
}

.weight-stat {
  background: rgba(0, 12, 36, 0.78);
  border: 1px solid rgba(81, 255, 231, 0.5);
  border-radius: 18px;
  padding: 16px 18px;
  box-shadow: 0 0 16px rgba(81, 255, 231, 0.2);
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.weight-stat-label {
  font-size: 0.56em;
  letter-spacing: 0.18em;
  color: rgba(103, 234, 255, 0.75);
  text-transform: uppercase;
}

.weight-stat-value {
  font-size: 0.8em;
  letter-spacing: 0.08em;
  color: rgba(255, 255, 255, 0.86);
}

.weight-chart-wrapper {
  flex: 1;
  background: linear-gradient(135deg, rgba(0, 18, 46, 0.82), rgba(0, 10, 28, 0.9));
  border: 1px solid rgba(81, 255, 231, 0.35);
  border-radius: 22px;
  box-shadow: inset 0 0 22px rgba(0, 0, 0, 0.6), 0 0 28px rgba(81, 255, 231, 0.22);
  padding: 18px 18px 28px 18px;
  margin-bottom: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.weight-chart {
  width: 100%;
  height: 100%;
}

.weight-chart-bg {
  fill: none;
}

.weight-axis-line {
  stroke: rgba(81, 255, 231, 0.35);
  stroke-width: 1.4;
}

.weight-chart-line {
  fill: none;
  stroke: rgba(81, 255, 231, 0.88);
  stroke-width: 3;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.weight-chart-point {
  fill: rgba(207, 40, 255, 0.9);
  stroke: rgba(81, 255, 231, 0.8);
  stroke-width: 2.2;
}

.weight-chart-goal {
  stroke: rgba(255, 227, 121, 0.65);
  stroke-width: 2;
  stroke-dasharray: 6 6;
}

.weight-chart-labels text {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.45em;
  fill: rgba(103, 234, 255, 0.75);
  text-anchor: middle;
}

.weight-chart-labels text.weight-axis-label {
  text-anchor: end;
  transform: translate(-6px, 4px);
}

.weight-axis-label {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.45em;
  fill: rgba(103, 234, 255, 0.65);
}

.weight-goal-label {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.46em;
  fill: rgba(255, 227, 121, 0.9);
}

.weight-empty {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.72em;
  text-align: center;
  color: rgba(103, 234, 255, 0.7);
  margin: 40px 0 20px 0;
}


.weight-log-table {
  width: 100%;
  border-collapse: collapse;
}

.weight-log-table th,
.weight-log-table td {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.58em;
  letter-spacing: 0.08em;
  color: rgba(255, 255, 255, 0.85);
  padding: 12px 10px;
  border-bottom: 1px solid rgba(81, 255, 231, 0.18);
}

.weight-log-table thead th {
  text-transform: uppercase;
  color: var(--text-neon);
}

.weight-log-table tbody tr:hover {
  background: rgba(81, 255, 231, 0.08);
}

.diary-empty {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.72em;
  text-align: center;
  color: rgba(103, 234, 255, 0.7);
  margin: 40px 0 20px 0;
}

#calendario.show-diary {
  align-items: center;
  justify-content: flex-start;
  padding-top: 28px;
  padding-bottom: 28px;
  --top-mask-start: 0px;
  --bottom-mask-stop: 0px;
  overflow-y: auto;
  overflow-x: hidden;
}

#calendario.show-diary #diary-log-panel {
  display: flex;
}

#calendario.show-diary > :not(#diary-log-panel) {
  display: none !important;
}

#calendario.show-weight {
  align-items: center;
  justify-content: flex-start;
  padding-top: 28px;
  padding-bottom: 28px;
  --top-mask-start: 0px;
  --bottom-mask-stop: 0px;
  overflow-y: auto;
  overflow-x: hidden;
}

#calendario.show-weight #weight-log-panel {
  display: flex;
}

#calendario.show-weight > :not(#weight-log-panel) {
  display: none !important;
}

.diary-log-table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}

.diary-log-table thead tr {
  background: transparent;
}

.diary-log-table th {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.68em;
  color: var(--text-neon);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  padding: 10px 12px;
  text-align: left;
  vertical-align: bottom;
}

.diary-log-table td {
  padding: 10px 12px;
  background: transparent !important;
  text-align: left;
  vertical-align: top;
}

.diary-log-date-header,
.diary-log-date-cell {
  width: 32%;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.62em;
  letter-spacing: 0.08em;
  color: var(--text-neon);
  text-transform: uppercase;
}

.diary-log-summary-header,
.diary-log-summary-cell {
  width: 68%;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.62em;
  letter-spacing: 0.04em;
  color: rgba(255, 255, 255, 0.82);
}

.diary-log-table th:first-child,
.diary-log-table td:first-child {
  width: 32%;
}

.diary-log-table th:last-child,
.diary-log-table td:last-child {
  width: 68%;
}

.diary-log-row .diary-log-preview {
  display: -webkit-box;
  font-size: 0.62em;
  color: rgba(255, 255, 255, 0.78);
  letter-spacing: 0.03em;
  line-height: 1.6;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  min-height: calc(2 * 1.6em);
  word-break: break-word;
}

.diary-log-dropdown td {
  padding-top: 0;
  padding-bottom: 18px;
}

.diary-log-dropdown .diary-log-item {
  margin-top: 6px;
}

/* ==== PRÊMIOS ==== */
.reward-card {
  position: relative;
  width: min(90%, 680px);
  margin: 42px auto 18px;
  border-radius: 28px;
  overflow: hidden;
  cursor: pointer;
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  filter: none;
  transition: transform 0.45s cubic-bezier(.16, .84, .44, 1), box-shadow 0.45s ease, filter 0.35s ease;
}

.reward-card::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: var(--reward-card-bg);
  border: 1px solid var(--reward-card-border);
  box-shadow: var(--reward-card-glow);
  opacity: 0.95;
  z-index: 1;
  animation: rewardCardPulse 6s ease-in-out infinite;
}

.reward-card::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: radial-gradient(circle at 12% 12%, var(--reward-card-sheen), transparent 65%);
  mix-blend-mode: screen;
  opacity: 0.55;
  z-index: 3;
  pointer-events: none;
}

.reward-card-warp,
.reward-card-grid,
.reward-card-sheen {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  z-index: 2;
}

.reward-card-warp::before,
.reward-card-warp::after {
  content: '';
  position: absolute;
  inset: -40%;
  border-radius: 50%;
  border: 2px solid rgba(255, 255, 255, 0.08);
  opacity: 0.3;
  animation: cardWarpPulse 12s linear infinite;
}

.reward-card-warp::after {
  animation-delay: -6s;
  border-color: rgba(255, 255, 255, 0.12);
  opacity: 0.2;
}

.reward-card-grid {
  background: repeating-linear-gradient(90deg, var(--reward-card-grid-color) 0px, var(--reward-card-grid-color) 2px, transparent 2px, transparent 40px),
              repeating-linear-gradient(0deg, var(--reward-card-grid-color) 0px, var(--reward-card-grid-color) 2px, transparent 2px, transparent 40px);
  transform: perspective(600px) rotateX(65deg) scale(2);
  opacity: 0.22;
  mix-blend-mode: screen;
  animation: cardGridDrift 10s ease-in-out infinite;
}

.reward-card-sheen {
  background: linear-gradient(120deg, transparent 30%, rgba(255, 255, 255, 0.35) 50%, transparent 70%);
  transform: translateX(-120%);
  animation: cardSheenSweep 8s ease-in-out infinite;
  z-index: 4;
}

.reward-card-content {
  position: relative;
  z-index: 5;
  display: flex;
  flex-direction: column;
  gap: 18px;
  padding: clamp(26px, 5vw, 40px);
  color: #f5f8ff;
}

.reward-card-header {
  display: flex;
  align-items: center;
  gap: clamp(16px, 4vw, 28px);
}

.reward-card-icon {
  font-size: clamp(40px, 7vw, 68px);
  display: grid;
  place-items: center;
  width: clamp(76px, 12vw, 120px);
  height: clamp(76px, 12vw, 120px);
  border-radius: 24px;
  background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.35), transparent 70%),
              linear-gradient(135deg, rgba(0, 0, 0, 0.35), rgba(255, 255, 255, 0.05));
  border: 2px solid rgba(255, 255, 255, 0.12);
  box-shadow: 0 0 26px rgba(0, 0, 0, 0.55), 0 0 34px rgba(255, 255, 255, 0.18);
  color: var(--visual-accent);
}

.reward-card-text {
  display: flex;
  flex-direction: column;
  gap: 10px;
  flex: 1;
}

.reward-card-title {
  font-size: clamp(16px, 3.8vw, 24px);
  letter-spacing: 0.08em;
  color: var(--highlight);
  text-shadow: 0 0 18px rgba(255, 227, 121, 0.65), 0 0 28px rgba(81, 255, 231, 0.35);
}

.reward-card-desc {
  font-size: clamp(12px, 3vw, 16px);
  color: var(--text-neon);
  text-shadow: 0 0 12px rgba(81, 255, 231, 0.4);
  line-height: 1.6;
}

.reward-card-progress {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.reward-bar-bg {
  width: 100%;
  height: 16px;
  background: rgba(0, 0, 0, 0.35);
  border-radius: 999px;
  overflow: hidden;
  box-shadow: 0 0 17px rgba(81, 255, 231, 0.4), inset 0 0 12px rgba(0, 0, 0, 0.65);
  z-index: 5;
}

.reward-bar {
  height: 100%;
  background: var(--reward-bar-gradient);
  border-radius: inherit;
  transition: width 0.45s cubic-bezier(.6, 1.2, .16, 1.08);
  width: 0;
  box-shadow: 0 0 18px rgba(207, 40, 255, 0.45);
}

.reward-unlocked {
  font-size: clamp(12px, 2.6vw, 16px);
  color: var(--visual-progress-text);
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.reward-unlocked span {
  color: var(--visual-progress-accent);
}

.reward-card:hover {
  transform: translateY(-6px) scale(1.02);
}

.reward-card:active {
  transform: translateY(-1px) scale(0.99);
}

.reward-card:focus-visible {
  outline: 3px solid var(--visual-accent);
  outline-offset: 4px;
}

.reward-card.is-activating {
  transform: translateY(-6px) scale(1.03);
  filter: saturate(130%) drop-shadow(0 0 24px rgba(207, 40, 255, 0.35)) drop-shadow(0 0 24px rgba(81, 255, 231, 0.35));
}
.reward-unlocked {
  margin-top: 6px; color: #191d28;
  background: #51ffe7;
  border-radius: 8px; padding: 5px 18px;
  font-weight: bold; box-shadow: 0 0 11px #cf28ff44;
  font-family: 'Press Start 2P', monospace;
  font-size: 1.09em; display: inline-block;
  z-index: 3;
  letter-spacing: 1px;
}

/* ==== Remove cursor editável lateral ==== */
#calendario:focus,
#calendario *:focus {
  outline: none !important;
}

#calendario:focus,
#calendario *:focus:not(.diary-textarea) {
  caret-color: transparent !important;
}

/* ==== SCROLLBAR OCULTA ==== */
#calendario::-webkit-scrollbar { width: 7px; background: none;}
#calendario::-webkit-scrollbar-thumb { background: transparent; border-radius: 11px;}

/* ==== DREAMY REWARD PORTAL ==== */
.reward-glow-overlay {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 380;
  opacity: 0;
  transition: opacity 0.6s ease;
  mix-blend-mode: screen;
  overflow: hidden;
  backdrop-filter: blur(6px) saturate(140%);
}

.reward-glow-overlay.show {
  opacity: 1;
}

.reward-glow-overlay.fade {
  opacity: 0;
  transition: opacity 0.85s ease;
}

.reward-glow-overlay .glow-core,
.reward-glow-overlay .glow-rings,
.reward-glow-overlay .glow-rays {
  position: absolute;
  left: var(--portal-x, 50%);
  top: var(--portal-y, 50%);
  transform: translate(-50%, -50%);
  pointer-events: none;
}

.reward-glow-overlay .glow-core {
  width: clamp(220px, 28vw, 340px);
  height: clamp(220px, 28vw, 340px);
  border-radius: 50%;
  background: radial-gradient(circle at 35% 35%, var(--portal-primary, #51ffe7), transparent 58%),
              radial-gradient(circle, rgba(255, 255, 255, 0.18) 0%, transparent 60%),
              radial-gradient(circle, var(--portal-secondary, #cf28ff) 0%, transparent 65%);
  filter: blur(18px) saturate(120%);
  opacity: 0.92;
  animation: portalCore 1.6s cubic-bezier(.17, .9, .26, 1) forwards;
  box-shadow: 0 0 22px rgba(255, 255, 255, 0.25), 0 0 55px var(--portal-secondary, #cf28ff);
}

.reward-glow-overlay .glow-rings {
  width: clamp(320px, 36vw, 480px);
  height: clamp(320px, 36vw, 480px);
  border-radius: 50%;
  border: 2px solid transparent;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.35) 20%, transparent 70%);
  box-shadow: 0 0 44px rgba(255, 255, 255, 0.35), inset 0 0 44px rgba(255, 255, 255, 0.15);
  filter: blur(3px);
  animation: portalRings 1.8s ease forwards;
  mix-blend-mode: screen;
}

.reward-glow-overlay .glow-rays {
  width: clamp(420px, 55vw, 700px);
  height: clamp(420px, 55vw, 700px);
  border-radius: 50%;
  background: conic-gradient(from 90deg, rgba(255, 255, 255, 0.22), rgba(81, 255, 231, 0.12), rgba(255, 227, 121, 0.18), rgba(207, 40, 255, 0.18), rgba(255, 255, 255, 0.22));
  filter: blur(16px) saturate(150%);
  opacity: 0.8;
  animation: portalRays 1.7s cubic-bezier(.11, .75, .14, 1) forwards;
  mix-blend-mode: screen;
}

@keyframes portalCore {
  0% {
    transform: translate(-50%, -50%) scale(0.25);
    opacity: 0.4;
    filter: blur(24px) saturate(140%);
  }
  45% {
    transform: translate(-50%, -50%) scale(1.08);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scale(0.92);
    opacity: 0.72;
    filter: blur(22px) saturate(165%);
  }
}

@keyframes portalRings {
  0% {
    transform: translate(-50%, -50%) scale(0.35);
    opacity: 0.15;
  }
  50% {
    opacity: 0.9;
  }
  100% {
    transform: translate(-50%, -50%) scale(1.14);
    opacity: 0.4;
  }
}

@keyframes portalRays {
  0% {
    transform: translate(-50%, -50%) scale(0.35) rotate(-10deg);
    opacity: 0.25;
  }
  40% {
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scale(1.16) rotate(16deg);
    opacity: 0.72;
  }
}

/* ========== MEDIA QUERIES ========== */
@media (max-width: 980px) {
  .banner-gamer { width: 95vw; min-width: 80px; max-width: 99vw; top: 8px;}
  .banner-gamer-img { max-height: 110px; min-height: 44px;}
  .arcade-screen-curve { width: 99vw; min-width: 80px; max-width: 99vw; left: 50%; top: 54%;}
  .arcade-counters {
    width: 1920px;
    height: 1080px;
    top: 0;
    left: 0;
    transform: none;
    padding: 0;
  }
  .counter-label { font-size: 0.78em; }
  .counter-value { font-size: 1.37em; }
  .mes { font-size: 1.33em;}
}
@media (max-width: 650px) {
  .arcade-screen-curve { width: 99vw; min-width: 40px; left: 50%; top: 54%; border-radius: 28px 22px 28px 28px/32px 38px 31px 27px;}
  #calendario { font-size: 0.7em; padding: 0 1vw 120px 1vw;}
  .arcade-counters {
    width: 1920px;
    height: 1080px;
    top: 0;
    left: 0;
    transform: none;
    padding: 0;
  }
  .counter-label { font-size: 0.57em; }
  .counter-value { font-size: 1.09em; }
  .mes { font-size: 1.1em;}
}

/* ====== Confetti Celebration ====== */
#party-lights {
  position: fixed;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  display: none;
  z-index: 1999;
  background: radial-gradient(circle at 20% 20%, rgba(255,0,255,0.4), transparent 60%),
              radial-gradient(circle at 80% 30%, rgba(0,255,255,0.4), transparent 60%),
              radial-gradient(circle at 50% 80%, rgba(255,255,0,0.4), transparent 60%);
  animation: partyHue 3s linear infinite;
}
@keyframes partyHue {
  0% { filter: hue-rotate(0deg); }
  100% { filter: hue-rotate(360deg); }
}

#confetti-canvas, #reward-confetti {
  position: fixed;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  z-index: 2000;
  pointer-events: none;
  display: none;
}

#celebrate-text {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  animation: textBounce 1.2s ease-in-out infinite;
  font-family: 'Press Start 2P', monospace;
  font-size: 3.5em;
  color: #ffe379;
  text-shadow: 0 0 20px #51ffe7, 0 0 40px #cf28ff;
  z-index: 2001;
  display: none;
  pointer-events: none;
}

@keyframes textBounce {
  0%,100% { transform: translate(-50%, -50%) scale(1); }
  50% { transform: translate(-50%, -55%) scale(1.2); }
}

@keyframes danceShake {
  0%,100% { transform: translate(0,0) rotate(0deg); }
  25% { transform: translate(2px, -2px) rotate(1deg); }
  50% { transform: translate(-2px, 2px) rotate(0deg); }
  75% { transform: translate(2px, -2px) rotate(-1deg); }
}

.shake-dance {
  animation: danceShake 0.4s linear infinite;
}

/* === Apresentação com RGB Split === */
#calendario.show-rgb {
  animation: rgbSplitIn 0.6s forwards;
}

@keyframes rgbSplitIn {
  0% {
    opacity: 0;
    filter: drop-shadow(-8px 0 red) drop-shadow(8px 0 cyan);
    transform: translate(-50%, -50%) scale(0.95);
  }
  50% {
    filter: drop-shadow(4px 0 red) drop-shadow(-4px 0 cyan);
    transform: translate(-50%, -50%) scale(0.98);
  }
  100% {
    opacity: 1;
    filter: none;
    transform: translate(-50%, -50%);
  }
}

/* === Aparição dos contadores === */
.arcade-counters.show-stroke {
  animation: lightStroke 0.7s forwards;
}

@keyframes lightStroke {
  0% {
    opacity: 0;
    text-shadow: none;
    filter: drop-shadow(0 0 20px #fff);
  }
  100% {
    opacity: 1;
    text-shadow: 0 0 20px #51ffe7, 0 0 40px #cf28ff;
    filter: none;
  }
}

/* ========== REWARD VISUALIZER ========== */
body.visualizer-open {
  overflow: hidden;
}

#reward-visualizer {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 400;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.4s ease;
  --origin-dx: 0px;
  --origin-dy: 0px;
  --origin-scale: 0.55;
}

#reward-visualizer.show {
  display: flex;
  opacity: 1;
  pointer-events: auto;
}

#reward-visualizer.closing {
  pointer-events: none;
}

#reward-visualizer .visualizer-backdrop {
  position: absolute;
  inset: 0;
  background-image: var(--visual-background);
  background-size: 140% 140%;
  background-repeat: no-repeat;
  filter: saturate(120%);
  animation: backdropDrift 18s ease-in-out infinite;
  z-index: 1;
  backdrop-filter: blur(18px) saturate(135%);
}

#reward-visualizer .visualizer-backdrop::before,
#reward-visualizer .visualizer-backdrop::after {
  content: "";
  position: absolute;
  inset: -6%;
  pointer-events: none;
  mix-blend-mode: screen;
  filter: blur(18px) saturate(140%);
}

#reward-visualizer .visualizer-backdrop::before {
  background: linear-gradient(115deg, rgba(81, 255, 231, 0.18), transparent 40%),
              linear-gradient(-115deg, rgba(207, 40, 255, 0.16), transparent 38%),
              radial-gradient(circle at 30% 35%, rgba(255, 227, 121, 0.15), transparent 40%);
  opacity: 0.6;
}

#reward-visualizer .visualizer-backdrop::after {
  background: conic-gradient(from 0deg at 50% 50%, rgba(81, 255, 231, 0.18), rgba(207, 40, 255, 0.14), rgba(255, 227, 121, 0.12), rgba(81, 255, 231, 0.18));
  opacity: 0.45;
  transform: scale(1.05);
}

#reward-visualizer.entering .visualizer-backdrop {
  animation: backdropDrift 18s ease-in-out infinite, tunnelBackdrop 1.2s cubic-bezier(.11, .75, .14, 1) forwards;
}

#reward-visualizer::before {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 45%, rgba(81, 255, 231, 0.18) 0%, transparent 48%),
              radial-gradient(circle at 48% 52%, rgba(207, 40, 255, 0.16) 0%, transparent 60%),
              radial-gradient(circle at 52% 55%, rgba(255, 227, 121, 0.12) 0%, transparent 70%);
  opacity: 0.45;
  mix-blend-mode: screen;
  pointer-events: none;
  filter: blur(18px) saturate(130%);
}

#reward-visualizer::after {
  content: "";
  position: absolute;
  inset: -8%;
  background: radial-gradient(circle at 30% 20%, rgba(81, 255, 231, 0.25), transparent 35%),
              radial-gradient(circle at 70% 80%, rgba(207, 40, 255, 0.2), transparent 38%),
              radial-gradient(circle at 50% 60%, rgba(255, 227, 121, 0.14), transparent 42%);
  mix-blend-mode: screen;
  opacity: 0.5;
  pointer-events: none;
  filter: blur(24px) saturate(150%);
}

#reward-visualizer .visualizer-tunnel {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  z-index: 3;
  opacity: 0;
}

#reward-visualizer.entering .visualizer-tunnel {
  animation: tunnelFade 1.2s ease forwards;
}

.visualizer-tunnel .tunnel-layer {
  position: absolute;
  width: clamp(40vmax, 72vw, 90vmax);
  height: clamp(40vmax, 72vw, 90vmax);
  border-radius: 50%;
  border: 6px solid transparent;
  mix-blend-mode: screen;
  opacity: 0;
  filter: blur(2px);
  transform-origin: center;
}

.visualizer-tunnel .tunnel-layer-one {
  border-color: rgba(81, 255, 231, 0.8);
}

.visualizer-tunnel .tunnel-layer-two {
  border-color: rgba(207, 40, 255, 0.7);
}

.visualizer-tunnel .tunnel-layer-three {
  border-color: rgba(255, 227, 121, 0.6);
}

#reward-visualizer.entering .tunnel-layer-one {
  animation: tunnelLayerOne 1.2s cubic-bezier(.11, .75, .14, 1) forwards;
}

#reward-visualizer.entering .tunnel-layer-two {
  animation: tunnelLayerTwo 1.2s cubic-bezier(.11, .75, .14, 1) 0.08s forwards;
}

#reward-visualizer.entering .tunnel-layer-three {
  animation: tunnelLayerThree 1.2s cubic-bezier(.11, .75, .14, 1) 0.16s forwards;
}

#reward-visualizer .visualizer-warp {
  position: absolute;
  inset: -20vmax;
  display: grid;
  place-items: center;
  overflow: hidden;
  pointer-events: none;
  z-index: 2;
}

#reward-visualizer .visualizer-warp::before {
  content: "";
  position: absolute;
  width: 120vmax;
  height: 120vmax;
  border-radius: 50%;
  background: radial-gradient(circle, var(--visual-warp-start) 0%, transparent 70%);
  filter: blur(0);
  opacity: 0;
  transform: scale(0.3);
}

#reward-visualizer.entering .visualizer-warp::before {
  animation: portalZoom 1.1s cubic-bezier(.13, .81, .34, 1) forwards;
}

#reward-visualizer .warp-ring {
  position: absolute;
  width: 120vmax;
  height: 120vmax;
  border-radius: 50%;
  border: 2px solid transparent;
  border-color: var(--visual-warp-start);
  mix-blend-mode: screen;
  opacity: 0.22;
  transform: scale(0.45);
  animation: warpRing 12s linear infinite;
}

#reward-visualizer.entering .warp-ring {
  animation: warpRingBurst 1.2s cubic-bezier(.11, .75, .14, 1) forwards;
}

#reward-visualizer .warp-ring-two {
  animation-delay: -4s;
  border-color: var(--visual-warp-end);
  opacity: 0.18;
}

#reward-visualizer .warp-ring-three {
  animation-delay: -8s;
  border-color: var(--visual-primary);
  opacity: 0.12;
}

#reward-visualizer .visualizer-grid {
  display: none;
}

#reward-visualizer.entering .visualizer-grid {
  display: none;
}

@keyframes gridPulse {
  0%, 100% { opacity: 0; }
  40% { opacity: 0; }
  70% { opacity: 0; }
}

#reward-visualizer .visualizer-particles {
  position: absolute;
  inset: 0;
  overflow: hidden;
  pointer-events: none;
  z-index: 5;
}

#reward-visualizer.entering .visualizer-particles {
  opacity: 0;
  filter: blur(6px);
}

#reward-visualizer.show:not(.entering) .visualizer-particles {
  opacity: 1;
  filter: none;
}

#reward-visualizer .visualizer-haze {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, var(--visual-haze), transparent 70%);
  opacity: 0.18;
  mix-blend-mode: screen;
  pointer-events: none;
  animation: portalHaze 8s ease-in-out infinite;
  z-index: 4;
}

#reward-visualizer.entering .visualizer-haze {
  animation: portalHaze 8s ease-in-out infinite, tunnelHaze 1.2s cubic-bezier(.11, .75, .14, 1) forwards;
}

#reward-visualizer .visualizer-particles span {
  position: absolute;
  font-size: clamp(72px, 18vw, 220px);
  color: var(--visual-particle-color);
  text-shadow: 0 0 30px var(--visual-particle-glow), 0 0 48px var(--visual-secondary);
  opacity: 0;
  animation: floatParticle linear infinite;
}

@keyframes floatParticle {
  0% { transform: translate3d(0, 80px, 0) scale(0.7); opacity: 0; }
  15% { opacity: 0.65; }
  45% { opacity: 0.9; }
  100% { transform: translate3d(0, -280px, 0) scale(1.6); opacity: 0; }
}

@keyframes tunnelFade {
  0% { opacity: 0; }
  20% { opacity: 0.35; }
  55% { opacity: 0.85; }
  100% { opacity: 0; }
}

@keyframes tunnelLayerOne {
  0% { transform: scale(0.25); opacity: 0; }
  35% { opacity: 0.9; }
  100% { transform: scale(1.3); opacity: 0; filter: blur(12px); }
}

@keyframes tunnelLayerTwo {
  0% { transform: scale(0.18); opacity: 0; }
  45% { opacity: 0.75; }
  100% { transform: scale(1.6); opacity: 0; filter: blur(18px); }
}

@keyframes tunnelLayerThree {
  0% { transform: scale(0.12); opacity: 0; }
  55% { opacity: 0.6; }
  100% { transform: scale(1.9); opacity: 0; filter: blur(24px); }
}

@keyframes warpRingBurst {
  0% { transform: scale(0.45); opacity: 0.1; }
  45% { opacity: 0.6; }
  100% { transform: scale(1.9); opacity: 0; }
}

@keyframes screenSuck {
  0% {
    transform: perspective(1600px) translate3d(var(--wrapper-translate-x), var(--wrapper-translate-y), 0) scale(var(--wrapper-scale));
    filter: brightness(1) saturate(100%) blur(0);
  }
  60% {
    transform: perspective(1400px) translate3d(calc(var(--wrapper-translate-x) + 26px), calc(var(--wrapper-translate-y) + 26px), 160px) scale(calc(var(--wrapper-scale) * 1.18)) rotateX(6deg);
    filter: brightness(1.28) saturate(145%) blur(2px);
  }
  100% {
    transform: perspective(1200px) translate3d(calc(var(--wrapper-translate-x) + 42px), calc(var(--wrapper-translate-y) + 42px), 320px) scale(calc(var(--wrapper-scale) * 1.34)) rotateX(9deg);
    filter: brightness(1.44) saturate(168%) blur(1.5px);
  }
}

@keyframes tunnelBackdrop {
  0% { transform: scale(1); filter: blur(0); opacity: 0.6; }
  100% { transform: scale(1.3); filter: blur(6px); opacity: 0.2; }
}

@keyframes tunnelFlash {
  0% { opacity: 0; }
  20% { opacity: 0.65; }
  55% { opacity: 0.4; }
  100% { opacity: 0; }
}

@keyframes tunnelHaze {
  0% { opacity: 0.12; filter: blur(0); }
  55% { opacity: 0.42; filter: blur(4px); }
  100% { opacity: 0.18; filter: blur(0); }
}

@keyframes warpRing {
  0% { transform: scale(0.45) rotate(0deg); opacity: 0.08; }
  45% { opacity: 0.35; }
  100% { transform: scale(1.1) rotate(360deg); opacity: 0.08; }
}

@keyframes portalZoom {
  0% { opacity: 0; transform: scale(0.2); }
  45% { opacity: 0.85; transform: scale(0.95); }
  100% { opacity: 0; transform: scale(1.3); }
}

@keyframes gridLift {
  0% { opacity: 0; transform: perspective(900px) rotateX(78deg) scale(1.4); }
  60% { opacity: 0.55; }
  100% { opacity: 0.45; transform: perspective(900px) rotateX(68deg) scale(1.8); }
}

@keyframes portalHaze {
  0%, 100% { opacity: 0.15; }
  45% { opacity: 0.35; }
  70% { opacity: 0.25; }
}

@keyframes contentDrop {
  0% { opacity: 0; transform: translate3d(0, 140px, -240px) scale(0.88); filter: blur(6px); }
  55% { opacity: 1; transform: translate3d(0, -18px, 60px) scale(1.04); filter: blur(1px); }
  100% { opacity: 1; transform: translate3d(0, 0, 0) scale(1); filter: blur(0); }
}

@keyframes contentMorph {
  0% { opacity: 0; transform: translate3d(var(--origin-dx), var(--origin-dy), -280px) scale(var(--origin-scale)) rotateX(14deg); filter: blur(10px) saturate(130%); }
  50% { opacity: 1; transform: translate3d(calc(var(--origin-dx) * 0.15), calc(var(--origin-dy) * 0.15), 40px) scale(1.04) rotateX(6deg); filter: blur(2px) saturate(120%); }
  100% { opacity: 1; transform: translate3d(0, 0, 0) scale(1) rotateX(0deg); filter: blur(0) saturate(110%); }
}

@keyframes contentExit {
  0% { opacity: 1; transform: translate3d(0, 0, 0) scale(1); }
  100% { opacity: 0; transform: translate3d(0, 40px, -80px) scale(0.92); }
}

@keyframes backdropDrift {
  0% { background-position: 0% 0%; }
  50% { background-position: 50% 60%; }
  100% { background-position: 0% 100%; }
}

@keyframes portalShadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

@keyframes rewardCardPulse {
  0%, 100% { opacity: 0.9; filter: saturate(100%); }
  50% { opacity: 1; filter: saturate(130%); }
}

@keyframes cardWarpPulse {
  0% { transform: scale(0.6) rotate(0deg); opacity: 0.12; }
  50% { transform: scale(1.15) rotate(180deg); opacity: 0.35; }
  100% { transform: scale(1.6) rotate(360deg); opacity: 0.12; }
}

@keyframes cardGridDrift {
  0% { transform: perspective(600px) rotateX(72deg) scale(1.6); }
  50% { transform: perspective(600px) rotateX(65deg) scale(2) translateY(6%); }
  100% { transform: perspective(600px) rotateX(72deg) scale(1.6); }
}

@keyframes cardSheenSweep {
  0%, 55% { transform: translateX(-130%); opacity: 0; }
  65% { opacity: 0.8; }
  80% { transform: translateX(130%); opacity: 0; }
  100% { transform: translateX(130%); opacity: 0; }
}

#reward-visualizer .visualizer-content {
  position: relative;
  width: min(1120px, 88vw);
  padding: clamp(26px, 6vw, 52px);
  border-radius: 28px;
  background: var(--visual-content-bg);
  border: 3px solid var(--visual-content-border);
  box-shadow: var(--visual-content-shadow);
  display: flex;
  flex-direction: column;
  gap: clamp(18px, 3vw, 32px);
  backdrop-filter: blur(18px);
  color: #f5f8ff;
  transform: translate3d(0, 0, 0) scale(1);
  opacity: 0;
  filter: none;
  transition: opacity 0.6s ease, transform 0.9s cubic-bezier(.16, .84, .44, 1), filter 0.6s ease;
  z-index: 10;
}

#reward-visualizer.show .visualizer-content {
  opacity: 0;
}

#reward-visualizer.entering .visualizer-content {
  opacity: 0;
  transform: translate3d(0, 160px, -320px) scale(0.38) rotateX(18deg);
  filter: blur(6px);
}

#reward-visualizer.show:not(.entering) .visualizer-content {
  opacity: 1;
  filter: none;
  animation: contentDrop 1.1s cubic-bezier(.12, .82, .21, 1.01) forwards;
}

#reward-visualizer.closing .visualizer-content {
  animation: contentExit 0.42s ease forwards;
}

#reward-visualizer.from-card .visualizer-content {
  transform: translate3d(var(--origin-dx), var(--origin-dy), -280px) scale(var(--origin-scale)) rotateX(14deg);
  filter: blur(10px) saturate(130%);
  opacity: 0;
}

#reward-visualizer.show.from-card:not(.entering) .visualizer-content {
  animation: contentMorph 1.2s cubic-bezier(.16, .84, .44, 1.08) forwards;
}

#reward-visualizer .visualizer-content::before,
#reward-visualizer .visualizer-content::after {
  content: "";
  position: absolute;
  inset: 8px;
  border-radius: inherit;
  border: 1px solid var(--visual-inner-border);
  pointer-events: none;
}

#reward-visualizer .visualizer-content::after {
  inset: 0;
  border: none;
  background: var(--visual-content-sheen);
  mix-blend-mode: screen;
  opacity: 0.4;
}

#reward-visualizer .visualizer-close {
  position: absolute;
  top: clamp(12px, 2vw, 24px);
  right: clamp(12px, 2vw, 24px);
  background: rgba(0, 0, 0, 0.4);
  border: 2px solid rgba(255, 255, 255, 0.4);
  color: var(--visual-accent);
  font-family: inherit;
  font-size: clamp(16px, 2vw, 24px);
  line-height: 1;
  width: clamp(36px, 3vw, 52px);
  height: clamp(36px, 3vw, 52px);
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 0 18px rgba(0,0,0,0.6);
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}

#reward-visualizer .visualizer-close:hover {
  transform: scale(1.08);
  border-color: var(--visual-primary);
  box-shadow: 0 0 28px var(--visual-primary);
}

#reward-visualizer .visualizer-headline {
  display: flex;
  gap: clamp(16px, 4vw, 28px);
  align-items: center;
  flex-wrap: wrap;
}

#reward-visualizer .visualizer-icon {
  width: clamp(80px, 12vw, 140px);
  height: clamp(80px, 12vw, 140px);
  border-radius: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(38px, 7vw, 68px);
  color: var(--visual-accent);
  background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.45), transparent 70%),
              linear-gradient(135deg, rgba(0, 0, 0, 0.1), rgba(0, 12, 30, 0.9));
  border: 2px solid rgba(255, 255, 255, 0.2);
  box-shadow: 0 0 30px rgba(0, 0, 0, 0.6), 0 0 45px var(--visual-primary);
  position: relative;
  overflow: hidden;
}

#reward-visualizer .visualizer-icon::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(120deg, transparent 0%, rgba(255, 255, 255, 0.25) 50%, transparent 100%);
  mix-blend-mode: screen;
}

#reward-visualizer .visualizer-title {
  font-size: clamp(20px, 4.2vw, 36px);
  color: var(--visual-primary);
  text-shadow: 0 0 12px rgba(81, 255, 231, 0.6), 0 0 35px rgba(207, 40, 255, 0.55);
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

#reward-visualizer .visualizer-tagline {
  font-size: clamp(14px, 2.6vw, 20px);
  color: var(--visual-tagline-color);
  text-shadow: 0 0 12px rgba(255, 227, 121, 0.5);
  margin-top: 6px;
}

#reward-visualizer .visualizer-description {
  font-size: clamp(12px, 2.3vw, 18px);
  line-height: 1.6;
  color: rgba(245, 248, 255, 0.92);
  text-shadow: 0 0 12px rgba(0, 0, 0, 0.8);
}

#reward-visualizer .visualizer-details {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

#reward-visualizer .visualizer-details .chip {
  padding: 10px 18px;
  border-radius: 999px;
  background: var(--visual-chip-bg);
  border: 1px solid var(--visual-chip-border);
  font-size: clamp(10px, 2vw, 14px);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--visual-chip-color);
  box-shadow: var(--visual-chip-shadow);
}

#reward-visualizer .visualizer-progress {
  display: flex;
  flex-direction: column;
  gap: 12px;
  font-size: clamp(11px, 2vw, 16px);
  letter-spacing: 0.08em;
}

#reward-visualizer .visualizer-progress-bar {
  position: relative;
  width: 100%;
  height: 16px;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.12);
  overflow: hidden;
  box-shadow: inset 0 0 14px rgba(0, 0, 0, 0.8);
}

#reward-visualizer .visualizer-progress-bar span {
  position: absolute;
  inset: 0;
  width: var(--progress, 0%);
  background: var(--visual-progress-bar);
  box-shadow: 0 0 18px var(--visual-primary);
  transition: width 0.45s ease;
}

#reward-visualizer .visualizer-progress-meta {
  display: flex;
  justify-content: space-between;
  gap: 12px;
  flex-wrap: wrap;
  color: var(--visual-progress-text);
}

#reward-visualizer .visualizer-progress-meta strong {
  color: var(--visual-progress-accent);
}

#reward-visualizer .visualizer-progress-meta.visualizer-level-up {
  justify-content: center;
  gap: 18px;
  font-size: clamp(13px, 2.6vw, 20px);
  text-transform: uppercase;
  letter-spacing: 0.14em;
  color: var(--visual-accent);
  text-shadow: 0 0 22px rgba(81, 255, 231, 0.45), 0 0 36px rgba(207, 40, 255, 0.35);
}

#reward-visualizer .visualizer-progress-meta.visualizer-level-up strong {
  color: var(--visual-accent);
  font-size: 1.05em;
  text-shadow: 0 0 26px rgba(81, 255, 231, 0.6), 0 0 40px rgba(207, 40, 255, 0.45);
}

@media (max-width: 720px) {
  #reward-visualizer .visualizer-content {
    border-radius: 22px;
    padding: 24px 18px 32px;
  }

  #reward-visualizer .visualizer-details {
    gap: 10px;
  }

  #reward-visualizer .visualizer-details .chip {
    padding: 8px 14px;
  }
}

